<!--
  Copyright 2013 Sébastien Ferré, IRISA, Université de Rennes 1

  This file is part of Sparklis.
  -->
{% extends "base.html" %}

{% block head %}
{{ super() }}
	<style type="text/css">
        #mynetwork {
            width: 100%;
            height: 800px;
            border: 1px solid lightgray;
        }
    </style>
<script>
	window.dataLayer = window.dataLayer || [];
	function gtag() { dataLayer.push(arguments); }
	gtag('js', new Date());

	gtag('config', 'your_analytiks_tag');
</script>
<link href="{{ url_for('static', filename='osparklis.css') }}" rel="stylesheet" type="text/css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script type="text/javascript" src="{{ url_for('static', filename='osparklis.js') }}"></script>
<!-- <script src="http://d3js.org/d3.v3.min.js"></script> -->
<script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
<script>
	var nameSpaces = {};

	legacyAlert = alert;
	alert = function () {};

	function filterNodesById(nodes, id) {
		return nodes.filter(function (n) { return n.id === id; });
	}

	function triplesToGraph(triples) {

		// svg.html("");
		//Graph
		var graph = { nodes: [], links: [] };

		//Initial Graph from triples
		triples.forEach(function (triple) {
			var subjId = triple.subject;
			var predId = triple.predicate;
			var objId = triple.object;

			var subjNode = filterNodesById(graph.nodes, subjId)[0];
			var objNode = filterNodesById(graph.nodes, objId)[0];

			if (subjNode == null) {
				subjNode = { id: subjId, label: subjId};
				graph.nodes.push(subjNode);
			}

			if (objNode == null) {
				objNode = { id: objId, label: objId};
				graph.nodes.push(objNode);
			}

			graph.links.push({ from: subjId, to: objId, label: predId});
		});
		var data = {nodes: new vis.DataSet(graph.nodes),
					edges: new vis.DataSet(graph.links)};
		return data;
	}

	function generateGraph(weirdObject) {

		var triples = [];
		
		function generateNamespace(result){
			var res = "";
			if(result.type == 'uri'){
				let myStrList =result.uri.split('/');
				lastElement = myStrList[myStrList.length-1];
				myStrList.pop();
				nspace = myStrList.join('/');
				if(!nameSpaces.hasOwnProperty(nspace)){
					var size = Object.keys(nameSpaces).length;
					nameSpaces[nspace] = 'x'+size;
				}
				res = nameSpaces[nspace] + ':' + lastElement; 
			}
			else {
				if (result.type == 'bnode'){
					res = result.id;
				}
				else if (result.type == 'var'){
					res = result.name;
				}
				else{
					res = result.str;
				}
			}
			return res;
		}

		for (let i = 0; i < weirdObject.rows.length; i++) {
			triple = {}
			subj = generateNamespace(weirdObject.rows[i][0]);
			pred = generateNamespace(weirdObject.rows[i][1]);
			obj = generateNamespace(weirdObject.rows[i][2]);
			triples.push({ subject: subj, predicate: pred, object: obj});
		}
		// svg.html("");

		function getTitle(Id){
			let myStrList = Id.split(':');
			var titleElement = document.createElement("div");
			titleElement.classList.add("card")
			var cardBody = document.createElement("div");
			cardBody.classList.add("card-body");
			titleElement.append(cardBody)
			var myList = document.createElement("table")
			myList.classList.add("table")
			myList.classList.add("table-borderless")
			var myBodyT = document.createElement("tbody")
			myList.append(myBodyT)
			cardBody.append(myList)
			if(myStrList.length == 2){
				for (const k in nameSpaces){
					if(nameSpaces[k] == myStrList[0]){
						//titleElement.innerHTML = "shorten uri: " + Id + '\n' + nameSpaces[k] + ':' + k;
						shorten1 = document.createElement('tr')
						th1 = document.createElement('th')
						th1.setAttribute("scope", "row")
						th1.innerHTML = "Shorten URI"
						td1 = document.createElement('td')
						td1.innerHTML = Id
						shorten1.append(th1,td1)
						shorten2 = document.createElement('tr')
						th2 = document.createElement("th")
						th2.setAttribute("scope", "row")
						th2.innerHTML = nameSpaces[k]
						td2 = document.createElement("td")
						td2.innerHTML = k
						shorten2.append(th2,td2)
						myBodyT.append(shorten1, shorten2)
						return titleElement;
					}
				}
			}
			cardBody.innerHTML = 'value:' + Id;
			return titleElement;
		}
		//Graph
		var graph = { nodes: [], links: [] };

		//Initial Graph from triples
		triples.forEach(function (triple) {
			var subjId = triple.subject;
			var predId = triple.predicate;
			var objId = triple.object;

			var subjNode = filterNodesById(graph.nodes, subjId)[0];

			var objNode = filterNodesById(graph.nodes, objId)[0];

			if (subjNode == null) {
				subjTitle = getTitle(subjId);
				subjNode = { id: subjId, label: subjId, title:subjTitle};
				graph.nodes.push(subjNode);
			}

			if (objNode == null) {
				objTitle = getTitle(objId);
				objNode = { id: objId, label: objId, title:subjTitle};
				graph.nodes.push(objNode);
			}

			graph.links.push({ from: subjId, to: objId, label: predId, title: getTitle(predId)});
		});
		var data = {nodes: new vis.DataSet(graph.nodes),
					edges: new vis.DataSet(graph.links)};
		return data;
		}
	// function cleanUri(myUri) {
	// 	let myStrList = myUri.split('/');
	// 	return myStrList[myStrList.length - 1];
	// }

	function parseThisShit(weirdObject) {
		var triples = [];
		for (let i = 0; i < weirdObject.rows.length; i++) {
			triples.push({ subject: weirdObject.rows[i][0].uri, predicate: weirdObject.rows[i][1].uri, object: weirdObject.rows[i][2].uri});
		}
		return triples;
	}

	// function runWhenSparklisUpdate(sparResults){
	// 	var triples = parseThisShit(sparResults);

	// 	var data = triplesToGraph(triples);
	// 	var container = document.getElementById('mynetwork');
	// 	var options = {}


    // 	// initialize your network!
    // 	var network = new vis.Network(container, data, options);
	// 	options = {
	// 		edges: {
  	// 		length: 500
	// 		}
	// 	}
	// 	network.setOptions(options);
	// }	

	function updateView(){
		var sparResults = sparklis.currentPlace().results()
		console.log(sparResults);
		console.log(sparklis.currentPlace().focusPath())
		var container = document.getElementById('mynetwork');
		if(sparResults.columns.length >= 3){
			//var triples = parseThisShit(sparResults);

			var data = generateGraph(sparResults); //triplesToGraph(triples);
			var options = {}


			// initialize your network!
			var network = new vis.Network(container, data, options);
			options = {
				edges: {
				length: 500
				}
			}
			network.setOptions(options);
		}
		else{
			legacyAlert('Results are not triples');
		}
	}
	//Wait until object sparklis get instanciated
	// $.getScript("{{ url_for('static', filename='osparklis.js') }}", function(){
	// 	sparklis_extension.hookResults = runWhenSparklisUpdate;
	// });

</script>

<!-- Run JS after everything is loaded -->
<script>
	var redirect = function() {
		//localStorage.setItem('results', JSON.stringify(sparklis.currentPlace().results()))
		//window.location = 'predict?results=' + JSON.stringify(sparklis.currentPlace().results())
		$.redirect('/predict', {'results': JSON.stringify(sparklis.currentPlace().results())})
	}
</script>
{% endblock %}

{% block main %}
	<div id="control-navig" class="navbar navbar-expand-lg" data-spy="affix" data-offset-top="75">
		<div class="">
			<span class="btn-group">
				<button id="button-home" class="btn btn-primary btn-lg navbar-btn">
					<span class="tooltiped">
						<span class="tooltip lang-en">Click to reset the query</span>
						<span class="tooltip lang-fr">Cliquer pour réinitialiser la requête</span>
						<span class="tooltip lang-es">Haga clic para restablecer la consulta</span>
						<span class="tooltip lang-nl">Klik om de query opnieuw in te stellen</span>
						<span class="glyphicon glyphicon-home"></span>
					</span>
				</button>
				<button id="button-back" class="btn btn-primary btn-lg navbar-btn">
					<span class="tooltiped">
						<span class="tooltip lang-en">Click to go back in navigation history</span>
						<span class="tooltip lang-fr">Cliquer pour revenir à la requête précédente</span>
						<span class="tooltip lang-es">Haga clic para volver a la anterior consulta</span>
						<span class="tooltip lang-nl">Klik om terug te gaan in de navigatie geschiedenis</span>
						<span class="glyphicon glyphicon-arrow-left"></span>
					</span>
				</button>
				<button id="button-forward" class="btn btn-primary btn-lg navbar-btn">
					<span class="tooltiped">
						<span class="tooltip lang-en">Click to go forward in navigation history</span>
						<span class="tooltip lang-fr">Cliquer pour retourner à la requête suivante</span>
						<span class="tooltip lang-es">Haga clic aquí para volver a la siguiente consulta</span>
						<span class="tooltip lang-nl">Klik om verder te gaan in de navigatie geschiedenis</span>
						<span class="glyphicon glyphicon-arrow-right"></span>
					</span>
				</button>
				<button id="button-refresh" class="btn btn-primary btn-lg navbar-btn">
					<span class="tooltiped">
						<span class="tooltip lang-en">Click to refresh the current view, e.g. after changing the
							configuration</span>
						<span class="tooltip lang-fr">Cliquer pour rafraîchir la vue actuelle, ex. après avoir changer
							la configuration</span>
						<span class="tooltip lang-es">Haga clic para refrescar la vista actual, ej., después de cambiar
							la configuración</span>
						<span class="tooltip lang-nl">Klik om de huidige weergave te vernieuwen, bijv. na het wijzigen
							van de configuratie</span>
						<span class="glyphicon glyphicon-refresh"></span>
					</span>
				</button>
			</span>

			<span class="tooltiped">
				<span class="tooltip lang-en">Click to display the permanent link to the current view</span>
				<span class="tooltip lang-fr">Cliquer pour afficher le lien permanent vers la vue actuelle</span>
				<span class="tooltip lang-es">Haga clic para mostrar el enlace permanente a la vista actual</span>
				<span class="tooltip lang-nl">Klik om de permanente link naar de huidige weergave weer te geven </span>
				<button id="permalink" class="btn btn-info btn-lg navbar-btn">Permalink</button>
			</span>

			<div class="btn-group btn-group-toggle" data-toggle="buttons">
				<label id="button-sparklis-view" class="btn btn-default btn-md navbar-btn active">
					<input type="radio" name="options" autocomplete="off" checked>
					Sparklis
				</label>
				<!-- <label id="button-yasgui-view" class="btn btn-default btn-md navbar-btn">
					<input type="radio" name="options" autocomplete="off">
					YASGUI
				</label> -->
				<label id="button-log-view" class="btn btn-default btn-md navbar-btn">
					<input type="radio" name="options" autocomplete="off">
					<span class="texte lang-en">History</span>
					<span class="texte lang-fr">Historique</span>
					<span class="texte lang-es">Historial</span>
					<span class="texte lang-nl">Geschiedenis</span>
				</label>
			</div>

		</div>
	</div>

	<div class="container-fluid">

		<div id="sparklis-view" class="panel-group">

			<div id="query" class="panel panel-info">
				<div class="panel-heading">
					<h5 class="panel-title">
						<span class="texte lang-en">Your query and its <span class="highlighted">current
								focus</span></span>
						<span class="texte lang-fr">Votre requête et son <span class="highlighted">focus
								actuel</span></span>
						<span class="texte lang-es">Tu consulta y su <span class="highlighted">foco
								actual</span></span>
						<span class="texte lang-nl">Uw query en zijn <span class="highlighted">huidige
								focus</span></span>

						<span class="texte lang-en"> (click on different parts of the query to change it)</span>
						<span class="texte lang-fr"> (cliquer sur différentes parties de la requêtes pour le
							changer)</span>
						<span class="texte lang-es"> (Haga clic sobre las diferentes partes de la consulta para
							cambiarlo)</span>
						<span class="texte lang-nl"> (Klik op verschillende delen van de query om deze te
							wijzingen)</span>
					</h5>
				</div>
				<div id="collapse-query" class="panel-collapse collapse show">
					<div id="query-body" class="panel-body">
						<span class="tooltiped">
							<span class="tooltip lang-en">Click on a query element to change focus</span>
							<span class="tooltip lang-fr">Cliquer sur un élément de requête pour changer le focus</span>
							<span class="tooltip lang-es">Haga clic en un elemento de consulta para cambiar el
								foco</span>
							<span class="tooltip lang-nl">Klik op een query-element om de focus te wijzigen</span>
							<div id="lisql">
							</div>
						</span>
					</div>
				</div>
			</div>

			<div id="increments" class="panel panel-info">
				<div class="panel-heading">
					<h5 class="panel-title">
						<span class="texte lang-en">Sparklis suggestions to refine your query</span>
						<span class="texte lang-fr">Suggestions de Sparklis pour affiner votre requête</span>
						<span class="texte lang-es">Sugerencias de Sparklis para refinar tu consulta</span>
						<span class="texte lang-nl">Sparklis suggesties om uw query te verfijnen</span>
					</h5>
				</div>
				<div id="collapse-increments" class="panel-collapse collapse show">
					<div id="increments-body" class="panel-body">
						<!--
	  <div id="current-focus">
	    <span class="texte lang-en">The current focus is </span>
	    <span class="texte lang-fr">Le focus actuel est </span>
	    <span class="texte lang-es">El foco actual es </span>
	    <span class="texte lang-nl">De huidige focus is </span>
	    <span class="increments-focus highlighted">the thing</span>
	    <em>The following suggestions are relative to</em> ''<span class="focus-np">the thing</span>'' <em>(the focus entity) and the <span class="highlighted">highlighted subquery</span></em>
	  </div>
	  -->

						<div class="row">
							<div class="incr-box col-sm-4">
								<div class="panel panel-default">
									<div class="panel-heading">
										<span class="texte lang-en">Types and Relations of</span>
										<span class="texte lang-fr">Types et Relations de</span>
										<span class="texte lang-es">Tipos y Relaciones de</span>
										<span class="texte lang-nl">Typen en Relaties van</span>
										<span class="focus-np">the thing</span>
									</div>
									<span class="tooltiped panel-body panel-body-incrs">
										<span class="tooltip lang-en">Click a concept to insert in the query at the
											focus</span>
										<span class="tooltip lang-fr">Cliquer un concept pour l'insérer au focus de la
											requête</span>
										<span class="tooltip lang-es">Haga clic para insertar un concepto en el foco de
											la consulta</span>
										<span class="tooltip lang-nl">Klik op een concept om deze toe te voegen aan de
											focus van de query</span>
										<div class="row">
											<div class="col-xs-4 no-padding">
												<select id="select-properties" class="select-incrs form-control">
													<option value="matchesAll">matches all</option>
													<option value="matchesAny">matches any</option>
												</select>
											</div>
											<div class="tooltiped col-xs-8 no-padding">
												<span class="tooltip lang-en">Input keywords to filter concepts</span>
												<span class="tooltip lang-fr">Saisir des mots-clés pour filtrer les
													concepts</span>
												<span class="tooltip lang-es">Introduzca palabras clave para filtrar los
													conceptos</span>
												<span class="tooltip lang-nl">Voer trefwoorden in om concepten te
													filteren</span>
												<input id="pattern-properties" class="pattern-incrs form-control"
													type="text">
											</div>
										</div>

										<span class="tooltiped">
											<span class="tooltip lang-en">Click to activate multi-selection</span>
											<span class="tooltip lang-fr">Cliquer pour activer la multi-sélection</span>
											<span class="tooltip lang-es">Haga clic para activar la
												multiselección</span>
											<span class="tooltip lang-nl">Klik om multi-selectie te activeren</span>
											<button id="selection-properties-button"
												class="btn btn-default btn-xs btn-block selection-incrs-button">
												<span class="texte lang-en">multi-selection</span>
												<span class="texte lang-fr">multi-sélection</span>
												<span class="texte lang-es">multiselección</span>
												<span class="texte lang-nl">multi-selectie</span>
											</button>
										</span>
										<div id="selection-properties" class="selection-incrs" style="display:none">
											<span class="texte lang-en">Insert the</span>
											<span class="texte lang-fr">Insérer les</span>
											<span class="texte lang-es">Insertar los</span>
											<span class="texte lang-nl">Voeg de</span>
											<span class="selection-count"></span>
											<span class="texte lang-en">selected items with</span>
											<span class="texte lang-fr">éléments sélectionnés avec</span>
											<span class="texte lang-es">elementos seleccionados con</span>
											<span class="texte lang-nl">geselecteerde items in met</span>
											<span id="selection-properties-items"></span>
										</div>
										<div id="list-properties" class="list-incrs css-treeview">
										</div>
									</span>
									<div class="panel-footer">
										<div class="container-fluid">
											<div class="row">
												<div class="col-xs-4 btn-group buttons-incrs">
													<span class="tooltiped btn btn-default btn-sm">
														<span class="tooltip lang-en">Turn the hierarchy
															upside-down</span>
														<span class="tooltip lang-fr">Retourner la hiérarchie à
															l'envers</span>
														<span class="tooltip lang-es">Darle la vuelta a la
															jerarquía</span>
														<span class="tooltip lang-nl">Breng de hiërarchie
															ondersteboven</span>
														<input id="input-inverse-properties" class="input-inverse"
															type="checkbox">
														<label for="input-inverse-properties"
															class="label-checked glyphicon glyphicon-chevron-up"></label>
														<label for="input-inverse-properties"
															class="label-unchecked glyphicon glyphicon-chevron-down"></label>
													</span>
													<span id="button-expand-properties" type="button"
														class="tooltiped btn btn-default btn-sm">
														<span class="tooltip lang-en">Expand all items</span>
														<span class="tooltip lang-fr">Développer tous les
															éléments</span>
														<span class="tooltip lang-es">Expandir todos los
															elementos</span>
														<span class="tooltip lang-nl">Vouw alle items uit</span>
														▼
													</span>
													<span id="button-collapse-properties" type="button"
														class="tooltiped btn btn-default btn-sm">
														<span class="tooltip lang-en">Collapse all items</span>
														<span class="tooltip lang-fr">Réduire tous les éléments</span>
														<span class="tooltip lang-es">Contraer todos los
															elementos</span>
														<span class="tooltip lang-nl">Alle items samenvouwen</span>
														►
													</span>
												</div>
												<div class="col-xs-4 no-padding">
													<select id="select-sorting-properties"
														class="select-sorting-incrs form-control">
														<!-- dynamically generated
			<option value="frequency">decreasing frequency</option>
			<option value="alphanum">alphanumeric order</option>
			-->
													</select>
												</div>
												<div id="count-properties" class="col-xs-4 count-incrs pull-right">
													<span class="texte lang-en">No concept</span>
													<span class="texte lang-fr">Aucun concept</span>
													<span class="texte lang-es">Ningún concepto</span>
													<span class="texte lang-nl">Geen concept</span>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div class="incr-box col-sm-4">
								<div class="panel panel-default">
									<div class="panel-heading">
										<span class="texte lang-en">Identities or Values of</span>
										<span class="texte lang-fr">Identités ou Valeurs de</span>
										<span class="texte lang-es">Identidades o Valores de</span>
										<span class="texte lang-nl">Identiteiten of Waarden van</span>
										<span class="focus-np">the thing</span>
									</div>
									<span class="tooltiped panel-body panel-body-incrs">
										<span class="tooltip lang-en">Click an entity to insert in the query at the
											focus</span>
										<span class="tooltip lang-fr">Cliquer une entité pour l'insérer au focus de la
											requête</span>
										<span class="tooltip lang-es">Haga clic en una entidad para insertarla en el
											foco de la consulta</span>
										<span class="tooltip lang-nl">Klik op een entiteit om deze toe te voegen aan de
											focus van de query</span>

										<div class="row">
											<div class="tooltiped col-xs-4 no-padding">
												<span class="tooltip lang-en">Select a filtering operator</span>
												<span class="tooltip lang-fr">Sélectionner un opérateur de
													filtrage</span>
												<span class="tooltip lang-es">Seleccionar un operador de filtrado</span>
												<span class="tooltip lang-nl">Selecteer een filter operator</span>
												<select id="select-terms" class="select-incrs form-control">
													<!-- dynamically generated
		      <option value="matchesAll">matches all</option>
		      <option value="matchesAny">matches any</option>
		      <option value="after">after</option>
		      <option value="before">before</option>
		      <option value="fromTo">from to</option>
		      <option value="higherThan">higher or equal to</option>
		      <option value="lowerThan">lower or equal to</option>
		      <option value="between">between</option>
		      <option value="hasLang">has language</option>
		      <option value="hasDatatype">has datatype</option>
		      -->
												</select>
											</div>
											<div class="tooltiped col-xs-7 no-padding">
												<span class="tooltip lang-en">Input keywords to filter entities</span>
												<span class="tooltip lang-fr">Saisir des mots-clés pour filtrer les
													entités</span>
												<span class="tooltip lang-es">Introduzca palabras clave para filtrar las
													entidades</span>
												<span class="tooltip lang-nl">Voer trefwoorden in om entiteiten te
													filteren</span>
												<input id="pattern-terms" class="pattern-incrs form-control"
													type="text">
											</div>
											<div class="tooltiped col-xs-1 no-padding">
												<span class="tooltip lang-en">Click this button to insert this filter at
													the query focus</span>
												<span class="tooltip lang-fr">Cliquer ce bouton pour insérer ce filtre
													au focus de la requête</span>
												<span class="tooltip lang-es">Haga clic en este botón para insertar este
													filtro en el foco de consulta</span>
												<span class="tooltip lang-nl">Klik op deze knop om dit filter toe te
													voegen aan de focus van de query</span>
												<button id="button-terms" class="btn btn-block btn-primary">
													<span class="glyphicon glyphicon-ok"></span>
												</button>
											</div>
										</div>
										<span class="tooltiped">
											<span class="tooltip lang-en">Click to activate multi-selection</span>
											<span class="tooltip lang-fr">Cliquer pour activer la multi-sélection</span>
											<span class="tooltip lang-es">Haga clic para activar la
												multiselección</span>
											<span class="tooltip lang-nl">Klik om multi-selectie te activeren</span>
											<button id="selection-terms-button"
												class="btn btn-default btn-xs btn-block selection-incrs-button">
												<span class="texte lang-en">multi-selection</span>
												<span class="texte lang-fr">multi-sélection</span>
												<span class="texte lang-es">multiselección</span>
												<span class="texte lang-nl">multi-selectie</span>
											</button>
										</span>
										<div id="selection-terms" class="selection-incrs" style="display:none">
											<span class="texte lang-en">Insert the</span>
											<span class="texte lang-fr">Insérer les</span>
											<span class="texte lang-es">Insertar los</span>
											<span class="texte lang-nl">Voeg de</span>
											<span class="selection-count"></span>
											<span class="texte lang-en">selected items with</span>
											<span class="texte lang-fr">éléments sélectionnés avec</span>
											<span class="texte lang-es">elementos seleccionados con</span>
											<span class="texte lang-nl">geselecteerde items in met</span>
											<span id="selection-terms-items"></span>
										</div>
										<div id="list-terms" class="list-incrs css-treeview">
										</div>
									</span>
									<div class="panel-footer">
										<div class="container-fluid">
											<div class="row">
												<div class="col-xs-4 btn-group buttons-incrs">
													<span class="tooltiped btn btn-default btn-sm">
														<span class="tooltip lang-en">Turn the hierarchy
															upside-down</span>
														<span class="tooltip lang-fr">Retourner la hiérarchie à
															l'envers</span>
														<span class="tooltip lang-es">Darle la vuelta a la
															jerarquía</span>
														<span class="tooltip lang-nl">Breng de hiërarchie
															ondersteboven</span>
														<input id="input-inverse-terms" class="input-inverse"
															type="checkbox">
														<label for="input-inverse-terms"
															class="label-checked glyphicon glyphicon-chevron-up"></label>
														<label for="input-inverse-terms"
															class="label-unchecked glyphicon glyphicon-chevron-down"></label>
													</span>
													<span id="button-expand-terms" type="button"
														class="tooltiped btn btn-default btn-sm">
														<span class="tooltip lang-en">Expand all items</span>
														<span class="tooltip lang-fr">Développer tous les
															éléments</span>
														<span class="tooltip lang-es">Expandir todos los
															elementos</span>
														<span class="tooltip lang-nl">Vouw alle items uit</span>
														▼
													</span>
													<span id="button-collapse-terms" type="button"
														class="tooltiped btn btn-default btn-sm">
														<span class="tooltip lang-en">Collapse all items</span>
														<span class="tooltip lang-fr">Réduire tous les éléments</span>
														<span class="tooltip lang-es">Contraer todos los
															elementos</span>
														<span class="tooltip lang-nl">Alle items samenvouwen</span>
														►
													</span>
												</div>
												<div class="col-xs-4 no-padding">
													<select id="select-sorting-terms"
														class="select-sorting-incrs form-control">
														<!-- dynamically generated
			<option value="frequency">decreasing frequency</option>
			<option value="alphanum">alphanumeric order</option>
			-->
													</select>
												</div>
												<div id="count-terms" class="col-xs-4 count-incrs pull-right">
													<span class="texte lang-en">No entity</span>
													<span class="texte lang-fr">Aucune entité</span>
													<span class="texte lang-es">Ninguna entidad</span>
													<span class="texte lang-nl">Geen entiteit</span>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>

							<div class="incr-box col-sm-4">
								<div class="panel panel-default">
									<div class="panel-heading">
										<span class="texte lang-en">Aggregations and Operators</span>
										<span class="texte lang-fr">Agrégations et Opérateurs</span>
										<span class="texte lang-es">Agregaciones y Operadores</span>
										<span class="texte lang-nl">Aggregatien en Operatoren</span>
									</div>
									<span class="tooltiped panel-body panel-body-incrs">
										<span class="tooltip lang-en">Click a modifier to insert in the query at the
											focus</span>
										<span class="tooltip lang-fr">Cliquer un modifieur pour l'insérer au focus de la
											requête</span>
										<span class="tooltip lang-es">Haga clic en un modificador para insertarlo en el
											foco de la consulta</span>
										<span class="tooltip lang-nl">Klik op een modifier om deze toe te voegen aan de
											focus van de query</span>
										<div class="row">
											<div class="col-xs-5 no-padding">
												<select id="select-modifiers" class="select-incrs form-control">
													<option value="matchesAll">matches all</option>
													<option value="matchesAny">matches any</option>
												</select>
											</div>
											<div class="tooltiped col-xs-7 no-padding">
												<span class="tooltip lang-en">Input keywords to filter modifiers</span>
												<span class="tooltip lang-fr">Saisir des mots-clés pour filtrer les
													modifieurs</span>
												<span class="tooltip lang-es">Introduzca palabras clave para filtrar los
													modificadores</span>
												<span class="tooltip lang-nl">Voer trefwoorden in om de modifiers te
													filteren</span>
												<input id="pattern-modifiers" class="pattern-incrs form-control"
													type="text">
											</div>
										</div>
										<span class="tooltiped">
											<span class="tooltip lang-en">Click to activate multi-selection</span>
											<span class="tooltip lang-fr">Cliquer pour activer la multi-sélection</span>
											<span class="tooltip lang-es">Haga clic para activar la
												multiselección</span>
											<span class="tooltip lang-nl">Klik om multi-selectie te activeren</span>
											<button id="selection-modifiers-button"
												class="btn btn-default btn-xs btn-block selection-incrs-button">
												<span class="texte lang-en">multi-selection</span>
												<span class="texte lang-fr">multi-sélection</span>
												<span class="texte lang-es">multiselección</span>
												<span class="texte lang-nl">multi-selectie</span>
											</button>
										</span>
										<div id="selection-modifiers" class="selection-incrs" style="display:none">
											<span class="texte lang-en">Insert the</span>
											<span class="texte lang-fr">Insérer les</span>
											<span class="texte lang-es">Insertar los</span>
											<span class="texte lang-nl">Voeg de</span>
											<span class="selection-count"></span>
											<span class="texte lang-en">selected items with</span>
											<span class="texte lang-fr">éléments sélectionnés avec</span>
											<span class="texte lang-es">artículos seleccionados con</span>
											<span class="texte lang-nl">geselecteerde items in met</span>
											<span id="selection-modifiers-items"></span>
										</div>
										<div id="list-modifiers" class="list-incrs css-treeview">
										</div>
									</span>
									<div id="count-modifiers" class="count-incrs panel-footer">
										<span class="texte lang-en">No modifier</span>
										<span class="texte lang-fr">Aucun modifieur</span>
										<span class="texte lang-es">Ningún modificador</span>
										<span class="texte lang-nl">Geen modifier</span>
									</div>
								</div>
							</div>

						</div>
					</div>
				</div>
			</div>

			<div id="results" class="panel panel-info">
				<div class="panel-heading">
					<h5 class="panel-title">
						<span class="texte lang-en">Results of your query</span>
						<span class="texte lang-fr">Résultats de votre requête</span>
						<span class="texte lang-es">Resultados de tu consulta</span>
						<span class="texte lang-nl">Resultaten van uw query</span>
						&nbsp;
						<!-- &nbsp;
						<span class="tooltiped">
							<span class="tooltip lang-en">Download results as a CSV file</span>
							<span class="tooltip lang-fr">Télécharger les résultats sous forme de fichier CSV</span>
							<span class="tooltip lang-es">Descargar los resultados en un archivo CSV</span>
							<span class="tooltip lang-nl">Resultaten downloaden als CSV-bestand</span>
							<button id="button-download-results" data-toggle="modal"
								data-target="#download-results-modal" class="btn btn-primary btn-xs">
								<span class="glyphicon glyphicon-download-alt"></span>
							</button>
						</span> -->
						<button id="button-predict" class="btn btn-primary btn-xs" onclick="redirect()">
								<span>Predict</span>
							</button>
					</h5>
				</div>
				<div id="collapse-results" class="panel-collapse collapse show">
					<div class="panel-body">
						<ul class="nav nav-tabs">
							<li id="nav-results-nested-table" class="active"><a id="nav-tab-nested-table"
									data-toggle="tab" data-target="#results-nested-table">
									<span class="texte lang-en">Nested Table</span>
									<span class="texte lang-fr">Tableau imbriqué</span>
									<span class="texte lang-es">Tabla anidada</span>
									<span class="texte lang-nl">Geneste Tafel</span>
								</a></li>
							<li id="nav-results-table"><a data-toggle="tab" data-target="#results-table">
									<span class="texte lang-en">Table</span>
									<span class="texte lang-fr">Tableau</span>
									<span class="texte lang-es">Tabla</span>
									<span class="texte lang-nl">Tafel</span>
								</a></li>
							<li id="nav-results-map"><a id="nav-tab-map" data-toggle="tab" data-target="#results-map"
									title="Click on this tab again if the map is not displayed correctly">
									<span class="texte lang-en">Map</span>
									<span class="texte lang-fr">Carte</span>
									<span class="texte lang-es">Mapa</span>
									<span class="texte lang-nl">Kaart</span>
								</a></li>
							<li id="nav-results-slideshow"><a id="nav-tab-slideshow" data-toggle="tab"
									data-target="#results-slideshow">
									<span class="texte lang-en">Slideshow</span>
									<span class="texte lang-fr">Diaporama</span>
									<span class="texte lang-es">Diapositivas</span>
									<span class="texte lang-nl">Diavoorstelling</span>
								</a></li>
								<li id="nav-results-view"><a id="nav-tab-view" data-toggle="tab"
									data-target=".results-view">
									<span class="texte lang-en">View</span>
								</a></li>
								<li class="tab-pane fade show results-view"><a onclick="updateView()">
									<span class="texte lang-en">Update</span>
								</a></li>
						</ul>
						<div class="tab-content">

							<div id="results-nested-table" class="tab-pane active">
								<div id="nested-table">
									No nested table
								</div>
								<div id="div-next-nested-table" class="tooltiped">
									<span class="tooltip lang-en">Click to show more results</span>
									<span class="tooltip lang-fr">Cliquer pour afficher plus de résultats</span>
									<span class="tooltip lang-es">Haga clic para mostrar mas resultados</span>
									<span class="tooltip lang-nl">Klik om meer resultaten te tonen</span>
									<button id="next-nested-table" class="btn btn-default"><span
											class="glyphicon glyphicon-chevron-down"></span></button>
								</div>
							</div>

							<div id="results-table" class="tab-pane">
								<div id="control-results">
									<span class="tooltiped">
										<span class="tooltip lang-en">Click to show the previous page of results</span>
										<span class="tooltip lang-fr">Cliquer pour afficher la page de résultats
											précédente</span>
										<span class="tooltip lang-es">Haga clic para mostrar la página anterior de
											resultados</span>
										<span class="tooltip lang-nl">Klik om de vorige pagina met resultaten weer te
											geven</span>
										<button id="previous-results" class="btn btn-default btn-md"><span
												class="glyphicon glyphicon-step-backward"></span></button>
									</span>
									<span id="count-results">
										<span class="texte lang-en">No result</span>
										<span class="texte lang-fr">Aucun résultat</span>
										<span class="texte lang-es">Ningún resultado</span>
										<span class="texte lang-nl">Geen resultaat</span>
									</span>
									<span class="tooltiped">
										<span class="tooltip lang-en">Click to show the next page of results</span>
										<span class="tooltip lang-fr">Cliquer pour afficher la page de résultats
											suivante</span>
										<span class="tooltip lang-es">Haga clic para mostrar la siguiente página de
											resultados</span>
										<span class="tooltip lang-nl">Klik om de volgende pagina met resultaten weer te
											geven</span>
										<button id="next-results" class="btn btn-default btn-md"><span
												class="glyphicon glyphicon-step-forward"></span></button>
									</span>
									<span class="texte lang-en">Show</span>
									<span class="texte lang-fr">Montrer</span>
									<span class="texte lang-es">Mostrar</span>
									<span class="texte lang-nl">Toon</span>
									<select id="limit-results" data-width="fit">
										<!-- NOT WORKING!!! -->
										<option value="10">10</option>
										<option value="20">20</option>
										<option value="50">50</option>
										<option value="100">100</option>
									</select>
									<span class="texte lang-en">results</span>
									<span class="texte lang-fr">résultats</span>
									<span class="texte lang-es">resultados</span>
									<span class="texte lang-nl">resultaten</span>
								</div>
								<span class="tooltiped">
									<span class="tooltip lang-en">Click an entity to insert in the query at the column's
										focus</span>
									<span class="tooltip lang-fr">Cliquer une entité pour l'insérer au focus de la
										requête</span>
									<span class="tooltip lang-es">Haga clic en una entidad para insertarla (en la
										consulta) en el foco de la columna </span>
									<span class="tooltip lang-nl">Klik op een entiteit om deze toe te voegen aan de
										focus van de query kolom</span>
									<div id="list-results">
									</div>
								</span>
							</div>

							<div id="results-map" class="tab-pane fade">
								<div id="map">
									No geolocalized data
								</div>
							</div>

							<div id="results-slideshow" class="tab-pane fade">
								<div id="results-carousel" class="carousel slide" data-interval="false">
									<!-- Wrapper for slides -->
									<div id="carousel-slides" class="carousel-inner">
										No media
									</div>
									<!-- Left and right controls -->
									<a class="left carousel-control" href="#results-carousel" data-slide="prev">
										<span class="glyphicon glyphicon-chevron-left"></span>
										<span class="sr-only">Previous</span>
									</a>
									<a class="right carousel-control" href="#results-carousel" data-slide="next">
										<span class="glyphicon glyphicon-chevron-right"></span>
										<span class="sr-only">Next</span>
									</a>
								</div>
							</div>

							<div id="results-view" class="tab-pane fade show results-view">
								<!-- <div id="svg-body" class="panel-body"></div> -->
								<div id="mynetwork"></div>
							</div>
						</div> <!-- .tab-content -->

					</div>
				</div>
			</div>
		</div>


		<div id="yasgui-view" class="panel panel-info" style="display:none">
			<div class="panel-heading">
				<h5 class="panel-title">
					<span class="texte lang-en">Your query in SPARQL + results (with YASGUI)</span>
					<span class="texte lang-fr">Votre requête en SPARQL + résultats (avec YASGUI)</span>
					<span class="texte lang-es">Tu consulta en SPARQL + resultados (con YASGUI)</span>
					<span class="texte lang-nl">Uw query in SPARQL + resultaten (met YASGUI)</span>
				</h5>
			</div>
			<div class="panel-body">
				<div id="sparql-query"></div>
				<div id="sparklis-yasgui"></div>
			</div>
		</div>

		<div id="log-view" class="panel panel-info" style="display:none">
			<div class="panel-heading">
				<h5 class="panel-title">
					<span class="texte lang-en">Your navigation history on this endpoint</span>
					<span class="texte lang-fr">Votre historique de navigation sur ce point d'accès</span>
					<span class="texte lang-es">Su historial de navegación en este SPARQL endpoint</span>
					<span class="texte lang-nl">Uw navigatiegeschiedenis op dit SPARQL endpoint</span>
					<button id="clear-log" class="btn btn-primary btn-xs" style="float: right">
						<span class="tooltiped">
							<span class="tooltip lang-en">Clear this history</span>
							<span class="tooltip lang-fr">Effacer cet historique</span>
							<span class="tooltip lang-es">Borrar este historial</span>
							<span class="tooltip lang-nl">Wis deze geschiedenis</span>
							<span class="glyphicon glyphicon-trash"></span>
						</span>
					</button>
				</h5>
			</div>
			<div class="panel-body">
				<div id="endpoint-log">
				</div>
			</div>
		</div>

	</div>
		<script>
			//Global variables for vizualization. Will probably get changed.
			// var svg = d3.select("#svg-body").append("svg")
			// 	.attr("width", 800)
			// 	.attr("height", 600)
			// 	.call(responsivefy)
			// 	;
			// var force = d3.layout.force();
		</script>
	</div>
{% endblock %}
